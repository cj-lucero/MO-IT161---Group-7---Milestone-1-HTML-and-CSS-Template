<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Climate Crisis Hub</title>
  <link rel="stylesheet" href="style.css">
  <!-- Font Awesome for icons -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
  <!-- Navbar -->
  <header class="navbar">
    <div class="logo">Climate Crisis Hub</div>
    <nav>
      <a href="#about" class="btn">About</a>
    </nav>
  </header>

  <!-- Hero Section -->
  <section class="hero reveal reveal-up" style="background-image: linear-gradient(rgba(0, 0, 0, 0.5), rgba(0, 0, 0, 0.5)), url('https://assets.newsweek.com/wp-content/uploads/2025/08/2135251-climate-change-over-time.jpg?w=1360&quality=75&webp=1'); background-size: cover; background-position: center; color: white; text-align: center; padding: 8rem 2rem;">
    <h1>Understanding Climate Change</h1>
    <p>Explore the causes, effects, and current status of the global climate crisis affecting our planet.</p>
    <a href="#about" class="btn-green">Learn More</a>
  </section>

  <!-- What is Climate Change -->
  <section class="about reveal reveal-down reveal-stagger reveal-stagger-down" id="about">
    <div class="about-img" style="max-width: 800px; margin: 0 auto;">
      <img src="https://cdn.cnn.com/cnnnext/dam/assets/190215162253-climate-change-explainer-super-tease.jpg" alt="Climate Change Explanation" style="width: 100%; border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);">
    </div>
    <div class="about-text">
      <h2><i class="fas fa-globe-americas"></i> What is Climate Change?</h2>
      <p>
        Climate change is the long-term shift in Earth's weather patterns, mostly driven by human activities like 
        burning fossil fuels, deforestation, and industrial pollution. These actions increase greenhouse gases in 
        the atmosphere, causing the planet to warm up, ice to melt, sea levels to rise, and extreme weather like 
        heat waves and storms to become more frequent. It’s altering ecosystems and affecting both nature and 
        human life.
      </p>
    </div>
  </section>

  <!-- Causes of Climate Change -->
  <section class="causes reveal reveal-left reveal-stagger reveal-stagger-left">
    <div class="causes-text">
      <h2><i class="fas fa-industry"></i> Causes of Climate Change</h2>
      <ul class="reveal reveal-stagger reveal-stagger-left">
        <li><span>1</span> <strong>Burning Fossil Fuels</strong> – The combustion of coal, oil, and natural gas releases greenhouse gases.</li>
        <li><span>2</span> <strong>Deforestation</strong> – Cutting down forests reduces the planet’s ability to absorb carbon dioxide.</li>
        <li><span>3</span> <strong>Industrial Pollution</strong> – Emissions from power plants and transportation contribute to the greenhouse effect.</li>
        <li><span>4</span> <strong>Waste Management</strong> – Poor waste segregation pollutes land and water sources.</li>
      </ul>
    </div>
    <div class="causes-img">
      <img src="https://cangeo-media-library.s3.amazonaws.com/s3fs-public/images/web_articles/article_images/5392/climate_change_header.jpg" alt="Causes of Climate Change" style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);">
    </div>
  </section>

  <!-- Effects of Climate Change -->
  <section class="effects reveal reveal-right reveal-stagger reveal-stagger-right">
    <div class="effects-img">
      <img src="https://www.azmilaw.com/wp-content/uploads/2024/10/Climate-Change-Bill-What-You-Have-To-Know-In-2-Minutes.jpg" alt="Effects of Climate Change" style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);">
    </div>
    <div class="effects-text">
      <h2><i class="fas fa-exclamation-triangle"></i> Effects of Climate Change</h2>
      <ul>
        <li><span>1</span> <strong>Rising Sea Levels</strong> – Melting ice sheets and glaciers are causing oceans to rise.</li>
        <li><span>2</span> <strong>Extreme Weather</strong> – Stronger storms and heatwaves are becoming more frequent.</li>
        <li><span>3</span> <strong>Ecosystem Disruption</strong> – Shifting temperatures alter habitats and disrupt biodiversity.</li>
      </ul>
    </div>
  </section>

  <!-- Climate Change in the Philippines -->
  <section class="philippines reveal reveal-up">
    <div class="philippines-text">
      <h2><i class="fas fa-map-marked-alt"></i> Climate Change in the Philippines</h2>
      <div class="ph-cards reveal reveal-stagger reveal-stagger-up">
        <div class="card"><h3>Heightened Displacement</h3><p>Storms and flooding are increasingly displacing people.</p></div>
        <div class="card"><h3>Frequent Storms</h3><p>The Philippines experiences around 20 tropical cyclones yearly.</p></div>
        <div class="card"><h3>Extreme Temperatures</h3><p>Hot extremes are becoming more intense and frequent.</p></div>
      </div>
    </div>
    <div class="philippines-img">
      <img src="https://static01.nyt.com/images/2013/11/10/world/asia/20131111PHILIPPINES-slide-VUFH/20131111PHILIPPINES-slide-VUFH-articleLarge.jpg" alt="Typhoon Haiyan Aftermath in the Philippines" style="border-radius: 15px; box-shadow: 0 8px 30px rgba(0,0,0,0.2);">
    </div>
  </section>

  <!-- Statistics -->
  <section class="statistics reveal reveal-down">
    <h2><i class="fas fa-chart-line"></i> Statistics (2024)</h2>
    <p>The following data was retrieved from the US's NOAA. The graphs show global temperature changes.</p>
    <img src="https://images.ctfassets.net/cxgxgstp8r5d/4azbkUvzl3UdkIHBqeePlQ/925f31fdcc9c03956cc3040e8327a307/2024HeatActionDay_DaysAbove90th_en_title_lg.jpg" alt="Global Temperature Anomalies" style="max-width: 100%; border-radius: 8px; margin: 20px 0; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
    <p>As the graph shows, the rates of temperature have drastically increased since the Industrial Revolution due to gases we release into the atmosphere.</p>
  </section>

  <!-- Video Section -->
  <section class="videos reveal reveal-left reveal-stagger reveal-stagger-left">
    <div class="videos-img">
      <img src="http://www.resources4rethinking.ca/media/Climate_Change_Collage_DRM_Free.jpg" alt="Climate Change Collage">
    </div>
    <div class="videos-text">
      <h2><i class="fas fa-video"></i> Related Videos</h2>
      <p>Gain a deeper understanding of climate change and its impact on societies and the environment.</p>
      <a href="#videos" class="btn-green">Go to Video Resources</a>
    </div>
  </section>

  <section id="videos" class="videos reveal reveal-right reveal-stagger reveal-stagger-right">
    <div class="videos-text">
      <h2>Video Resources</h2>
      <p>Watch these videos to learn more about climate change and its impacts.</p>
      <div class="video-container">
        <iframe src="https://www.youtube.com/embed/EtW2rrLHs08" title="Climate Change Explained" allowfullscreen></iframe>
      </div>
    </div>
  </section>

  <!-- Join the Movement -->
  <section class="movement reveal reveal-up">
    <h2><i class="fas fa-hands-helping"></i> Join the Climate Movement</h2>
    <ul class="reveal reveal-stagger reveal-stagger-up">
      <li><span>1</span> <strong>Reduce Your Carbon Footprint</strong> – Make eco-friendly choices daily.</li>
      <li><span>2</span> <strong>Support Climate Policies</strong> – Advocate for government and corporate action.</li>
      <li><span>3</span> <strong>Spread Awareness</strong> – Educate your community and inspire change.</li>
      <li><span>4</span> <strong>Get Involved Locally</strong> – Participate in community initiatives.</li>
    </ul>
  </section>

  <!-- Arctic Help Interactive Section -->
  <section class="arctic-help reveal reveal-down" aria-label="Help the polar bear with ice">
    <div class="arctic-stage">
      <button class="bear-btn bear-dry" id="polarBear" aria-label="Dying polar bear" title="Polar bear needs ice">
        <!-- Inline Polar Bear SVG Icon -->
        <svg class="bear-svg" viewBox="0 0 64 64" role="img" aria-label="Polar bear icon" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="bearFaceGrad" x1="0" y1="0" x2="0" y2="1">
              <stop offset="0%" stop-color="#ffffff"/>
              <stop offset="100%" stop-color="#e6f4fa"/>
            </linearGradient>
          </defs>
          <!-- Ears -->
          <circle cx="18" cy="16" r="8" fill="url(#bearFaceGrad)" stroke="#cfd8dc" stroke-width="2"/>
          <circle cx="46" cy="16" r="8" fill="url(#bearFaceGrad)" stroke="#cfd8dc" stroke-width="2"/>
          <!-- Head -->
          <circle cx="32" cy="32" r="22" fill="url(#bearFaceGrad)" stroke="#cfd8dc" stroke-width="2"/>
          <!-- Eyes -->
          <circle cx="24" cy="30" r="2.5" fill="#263238"/>
          <circle cx="40" cy="30" r="2.5" fill="#263238"/>
          <!-- Snout -->
          <ellipse cx="32" cy="38" rx="9" ry="7" fill="#f1fbff" stroke="#cfd8dc" stroke-width="1.5"/>
          <circle cx="32" cy="37" r="2.6" fill="#263238"/>
          <path d="M26 41 Q32 45 38 41" stroke="#90a4ae" stroke-width="2" fill="none" stroke-linecap="round"/>
        </svg>
      </button>
      <button class="catapult-btn" id="iceCatapult" aria-label="Catapult ice" title="Launch ice to the polar bear">
        <span class="arm" aria-hidden="true"></span>
        <i class="fas fa-icicles" aria-hidden="true"></i>
      </button>
    </div>
    <p class="arctic-note">Launch ice to help the polar bear!</p>
  </section>

  <!-- Footer -->
  <footer class="reveal reveal-left">
    <p>© 2025 Climate Crisis Hub | All Rights Reserved</p>
  </footer>

  <!-- Floating Tree Icon (grows on hover) -->
  <div class="floating-tree" aria-label="Grow tree" title="Grow me!">
    <i class="fas fa-tree" aria-hidden="true"></i>
  </div>

  <!-- Dying Tree and Sprinkler Icons -->
  <div class="floating-icon dying-tree" id="dyingTree" aria-label="Dying tree" title="Dying tree">
    <i class="fas fa-tree" aria-hidden="true"></i>
  </div>
  <div class="floating-icon sprinkler" id="sprinkler" aria-label="Sprinkler" title="Drag to water" tabindex="0">
    <i class="fas fa-shower" aria-hidden="true"></i>
  </div>

  <!-- Inline styles for new floating icons and animations -->
  <style>
    /* Generic floating icon base (used by dying tree and sprinkler) */
    .floating-icon {
      position: fixed;
      width: 64px;
      height: 64px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      box-shadow: 0 8px 24px rgba(34, 84, 61, 0.20), inset 0 0 10px rgba(255,255,255,0.6);
      cursor: grab;
      user-select: none;
      z-index: 210;
      transition: transform 0.25s ease, box-shadow 0.25s ease;
    }
    .floating-icon.dragging {
      cursor: grabbing;
      transform: scale(1.06);
      box-shadow: 0 12px 30px rgba(34,84,61,0.28), inset 0 0 12px rgba(255,255,255,0.75);
    }
    .floating-icon i {
      font-size: 28px;
      filter: drop-shadow(0 2px 2px rgba(0,0,0,0.15));
    }

    /* Dying tree icon */
    .dying-tree {
      background: radial-gradient(120px 120px at 30% 30%, #f1f8e9 0%, #d7ccc8 45%, #bcaaa4 100%);
      color: #6d4c41;
    }
    .dying-tree i { color: #6d4c41; }
    .dying-tree.healthy {
      background: radial-gradient(120px 120px at 30% 30%, #e8f5e9 0%, #c8e6c9 40%, #a5d6a7 100%);
    }
    .dying-tree.healthy i { color: #2e7d32; }

    /* Sprinkler icon */
    .sprinkler {
      background: radial-gradient(120px 120px at 30% 30%, #e3f2fd 0%, #bbdefb 45%, #90caf9 100%);
      color: #1565c0;
    }
    .sprinkler i { color: #1565c0; }

    /* Water droplet particle */
    .water-drop {
      position: fixed;
      left: 0;
      top: 0;
      width: 8px;
      height: 8px;
      border-radius: 50% 50% 60% 60%;
      background: linear-gradient(180deg, rgba(144,202,249,0.95), rgba(25,118,210,0.85));
      box-shadow: 0 1px 2px rgba(0,0,0,0.15);
      transform: translate(0, 0);
      pointer-events: none;
      z-index: 250;
      animation: drop-fall 1.1s ease-in forwards;
    }

    /* Missing keyframes for leaf burst (used by .leaf) */
    @keyframes leaf-burst {
      0% {
        transform: translate(0, 0) scale(0.6) rotate(0);
        opacity: 1;
      }
      70% {
        transform: translate(var(--tx), var(--ty)) scale(1) rotate(var(--rot));
        opacity: 1;
      }
      100% {
        transform: translate(calc(var(--tx) * 1.1), calc(var(--ty) + 20px)) scale(0.9) rotate(calc(var(--rot) + 20deg));
        opacity: 0;
      }
    }
  </style>
 

  <script>
    (function () {
      // Force animations on this page even if the OS prefers reduced motion
      document.body.classList.add('force-anim');
      const reduceMotion = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
      const force = document.body.classList.contains('force-anim');
      const revealEls = Array.from(document.querySelectorAll('.reveal'));
      console.log('[Reveal] targets:', revealEls.length, 'reduceMotion:', reduceMotion, 'force:', force);

      if (revealEls.length === 0) return;
      // Only disable animations if user prefers reduced motion AND we're not forcing animations
      if (reduceMotion && !force) {
        revealEls.forEach(el => el.classList.add('reveal-visible'));
        return;
      }

      const observer = new IntersectionObserver(
        (entries, obs) => {
          entries.forEach(entry => {
            if (entry.isIntersecting) {
              entry.target.classList.add('reveal-visible');
              console.log('[Reveal] shown:', entry.target.className);
              obs.unobserve(entry.target);
            }
          });
        },
        // Reveal as soon as any part enters, and a bit before the bottom of the viewport
        { root: null, rootMargin: '0px 0px -15% 0px', threshold: 0 }
      );

      // Observe all targets
      revealEls.forEach(el => observer.observe(el));
      console.log('[Reveal] observing all targets');

      function checkInView() {
        const vh = window.innerHeight || document.documentElement.clientHeight;
        revealEls.forEach(el => {
          if (el.classList.contains('reveal-visible')) return;
          const r = el.getBoundingClientRect();
          if (r.top < vh && r.bottom > 0) {
            el.classList.add('reveal-visible');
            observer.unobserve(el);
            console.log('[Reveal] in-view check revealed:', el.className);
          }
        });
      }

      // Initial check and also after images load, scroll, and resize
      checkInView();
      window.addEventListener('load', checkInView);
      window.addEventListener('scroll', checkInView, { passive: true });
      window.addEventListener('resize', checkInView);

      // Safety fallback: after 2s, ensure nothing remains hidden
      setTimeout(() => {
        revealEls.forEach(el => {
          if (!el.classList.contains('reveal-visible')) {
            el.classList.add('reveal-visible');
            try { observer.unobserve(el); } catch (e) {}
            console.log('[Reveal] fallback revealed:', el.className);
          }
        });
      }, 2000);
    })();
  </script>

  <script>
    // Show video section when clicking the button
    document.querySelector('.btn-green[href="#videos"]').addEventListener('click', function(e) {
      e.preventDefault();
      const videosSection = document.getElementById('videos');
      videosSection.style.display = 'flex';
      videosSection.style.opacity = '0';
      videosSection.scrollIntoView({ behavior: 'smooth' });
      
      // Fade in effect
      setTimeout(() => {
        videosSection.style.transition = 'opacity 0.5s ease-in-out';
        videosSection.style.opacity = '1';
      }, 100);
    });

    // Leaf burst on tree click
    (function() {
      const tree = document.querySelector('.floating-tree');
      if (!tree) return;

      function burstLeaves(evt) {
        const rect = tree.getBoundingClientRect();
        const originX = rect.left + rect.width / 2;
        const originY = rect.top + rect.height / 2;

        const leaves = 12;
        for (let i = 0; i < leaves; i++) {
          const leaf = document.createElement('span');
          leaf.className = 'leaf';

          const w = Math.random() * 10 + 6; // 6-16px
          const h = w * 0.6;
          leaf.style.width = w + 'px';
          leaf.style.height = h + 'px';

          leaf.style.left = (originX - w / 2) + 'px';
          leaf.style.top = (originY - h / 2) + 'px';

          const angle = Math.random() * Math.PI * 2;
          const distance = 60 + Math.random() * 60; // 60-120px
          const dx = Math.cos(angle) * distance;
          const dy = -Math.sin(angle) * distance; // bias upward a bit

          leaf.style.setProperty('--tx', dx + 'px');
          leaf.style.setProperty('--ty', dy + 'px');
          leaf.style.setProperty('--rot', (Math.random() * 180 - 90).toFixed(1) + 'deg');
          leaf.style.animationDuration = (800 + Math.random() * 600) + 'ms';

          // color variants
          leaf.style.background = Math.random() < 0.5 ? '#66bb6a' : '#43a047';

          document.body.appendChild(leaf);
          setTimeout(() => leaf.remove(), 1700);
        }
      }

      tree.addEventListener('click', burstLeaves);
    })();

    // Sprinkler drag-to-water interaction
    (function() {
      const sprinkler = document.getElementById('sprinkler');
      const dyingTree = document.getElementById('dyingTree');
      if (!sprinkler || !dyingTree) return;

      let dragging = false;
      let offsetX = 0, offsetY = 0;
      let pourInterval = null;
      let revertTimeout = null;
      let isPouring = false;

      function getCenter(el) {
        const r = el.getBoundingClientRect();
        return { x: r.left + r.width/2, y: r.top + r.height/2 };
      }

      function isNear(a, b, threshold = 90) {
        const ca = getCenter(a), cb = getCenter(b);
        const dx = ca.x - cb.x, dy = ca.y - cb.y;
        return Math.hypot(dx, dy) <= threshold;
      }

      function spawnDrop(x, y) {
        const d = document.createElement('span');
        d.className = 'water-drop';
        const size = 6 + Math.random() * 6;
        d.style.width = size + 'px';
        d.style.height = size + 'px';
        d.style.left = x + (Math.random() * 12 - 6) + 'px';
        d.style.top = y + (Math.random() * 8 - 4) + 'px';
        d.style.animationDuration = (600 + Math.random() * 500) + 'ms';
        document.body.appendChild(d);
        setTimeout(() => d.remove(), 1600);
      }

      function burstLeavesAtTree() {
        const rect = dyingTree.getBoundingClientRect();
        const originX = rect.left + rect.width/2;
        const originY = rect.top + rect.height/2;
        const leaves = 10;
        for (let i = 0; i < leaves; i++) {
          const leaf = document.createElement('span');
          leaf.className = 'leaf';
          const w = Math.random() * 10 + 6;
          const h = w * 0.6;
          leaf.style.width = w + 'px';
          leaf.style.height = h + 'px';
          leaf.style.left = (originX - w / 2) + 'px';
          leaf.style.top = (originY - h / 2) + 'px';
          const angle = Math.random() * Math.PI * 2;
          const distance = 40 + Math.random() * 50;
          const dx = Math.cos(angle) * distance;
          const dy = -Math.sin(angle) * distance;
          leaf.style.setProperty('--tx', dx + 'px');
          leaf.style.setProperty('--ty', dy + 'px');
          leaf.style.setProperty('--rot', (Math.random() * 180 - 90).toFixed(1) + 'deg');
          leaf.style.animationDuration = (900 + Math.random() * 600) + 'ms';
          leaf.style.background = Math.random() < 0.5 ? '#66bb6a' : '#43a047';
          document.body.appendChild(leaf);
          setTimeout(() => leaf.remove(), 2000);
        }
      }

      function startPour() {
        if (isPouring) return;
        isPouring = true;
        dyingTree.classList.add('healthy');
        burstLeavesAtTree();
        if (revertTimeout) clearTimeout(revertTimeout);
        revertTimeout = setTimeout(() => {
          dyingTree.classList.remove('healthy');
        }, 20000);
        const treeRect = dyingTree.getBoundingClientRect();
        pourInterval = setInterval(() => {
          const tx = treeRect.left + treeRect.width/2;
          const ty = treeRect.top + treeRect.height/2;
          for (let i = 0; i < 3; i++) spawnDrop(tx, ty - 8);
        }, 150);
      }

      function stopPour() {
        if (!isPouring) return;
        isPouring = false;
        if (pourInterval) {
          clearInterval(pourInterval);
          pourInterval = null;
        }
      }

      function onMove(e) {
        if (!dragging) return;
        const x = (e.touches ? e.touches[0].clientX : e.clientX) - offsetX;
        const y = (e.touches ? e.touches[0].clientY : e.clientY) - offsetY;
        sprinkler.style.left = x + 'px';
        sprinkler.style.top = y + 'px';
        if (isNear(dyingTree, sprinkler)) startPour(); else stopPour();
      }

      function onDown(e) {
        dragging = true;
        const r = sprinkler.getBoundingClientRect();
        const cx = (e.touches ? e.touches[0].clientX : e.clientX);
        const cy = (e.touches ? e.touches[0].clientY : e.clientY);
        offsetX = cx - (r.left + r.width/2);
        offsetY = cy - (r.top + r.height/2);
        sprinkler.classList.add('dragging');
        document.addEventListener('mousemove', onMove);
        document.addEventListener('touchmove', onMove, { passive: true });
      }

      function onUp() {
        if (!dragging) return;
        dragging = false;
        sprinkler.classList.remove('dragging');
        document.removeEventListener('mousemove', onMove);
        document.removeEventListener('touchmove', onMove);
        stopPour();
      }

      // Initialize absolute/fixed positioning for drag
      Object.assign(dyingTree.style, { position: 'fixed', left: '24px', bottom: '24px' });
      // Place the sprinkler near the dying tree (to its right)
      Object.assign(sprinkler.style, { position: 'fixed', left: '110px', bottom: '24px' });

      sprinkler.addEventListener('mousedown', onDown);
      sprinkler.addEventListener('touchstart', onDown, { passive: true });
      document.addEventListener('mouseup', onUp);
      document.addEventListener('touchend', onUp);
    })();

    // Arctic Help: catapult launches ice to polar bear
    (function() {
      const catapult = document.getElementById('iceCatapult');
      const bear = document.getElementById('polarBear');
      if (!catapult || !bear) return;

      let cooldown = false;

      function centerOf(el) {
        const r = el.getBoundingClientRect();
        return { x: r.left + r.width/2, y: r.top + r.height/2 };
      }

      function catapultArmTip(el) {
        // approximates the top of the arm element
        const btn = el.getBoundingClientRect();
        const arm = el.querySelector('.arm');
        if (!arm) return centerOf(el);
        const ar = arm.getBoundingClientRect();
        // tip near the top of the arm rect
        const tipX = ar.left + ar.width/2;
        const tipY = ar.top + 6; // a bit below top for nicer feel
        return { x: tipX, y: tipY };
      }

      function spawnSplash(x, y) {
        // ring
        const ring = document.createElement('span');
        ring.className = 'splash-ring';
        ring.style.left = x + 'px';
        ring.style.top = y + 'px';
        document.body.appendChild(ring);
        setTimeout(() => ring.remove(), 800);

        // shards
        const shards = 8;
        for (let i = 0; i < shards; i++) {
          const s = document.createElement('span');
          s.className = 'splash-shard';
          const angle = (Math.PI * 2 * i / shards) + (Math.random() * 0.4 - 0.2);
          const dist = 20 + Math.random() * 14;
          const tx = x + Math.cos(angle) * dist;
          const ty = y + Math.sin(angle) * dist;
          s.style.left = tx + 'px';
          s.style.top = ty + 'px';
          s.style.transform = `translate(-50%, -50%) rotate(${(angle*180/Math.PI).toFixed(0)}deg)`;
          document.body.appendChild(s);
          setTimeout(() => s.remove(), 700);
        }
      }

      function launchIce() {
        if (cooldown) return;
        cooldown = true;
        setTimeout(() => cooldown = false, 800); // brief cooldown

        // start from the catapult arm tip (right side)
        const start = catapultArmTip(catapult);
        const end = centerOf(bear);

        const ice = document.createElement('span');
        ice.className = 'ice-chunk';

        // Position via transform translate from (0,0)
        ice.style.transform = `translate(${start.x}px, ${start.y}px) rotate(0deg)`;
        document.body.appendChild(ice);

        // animate catapult arm
        catapult.classList.add('arm-active');

        // 5s arc animation from right (catapult) to left (bear)
        const duration = 5000; // ms
        const arcHeight = Math.max(120, Math.abs(end.x - start.x) * 0.25); // height of arc
        const startTime = performance.now();
        const startX = start.x;
        const startY = start.y;
        const dx = end.x - start.x;
        const dy = end.y - start.y;
        const spinStart = 0;
        const spinEnd = 720; // degrees over flight

        function easeOutCubic(t){ return 1 - Math.pow(1 - t, 3); }

        function step(now){
          const elapsed = now - startTime;
          let t = Math.min(elapsed / duration, 1);
          const te = easeOutCubic(t);

          // linear base path
          const x = startX + dx * te;
          const yLinear = startY + dy * te;
          // arc offset (upwards then down)
          const yArc = -Math.sin(Math.PI * te) * arcHeight; // negative lifts up
          const y = yLinear + yArc;
          const rot = spinStart + (spinEnd - spinStart) * te;

          ice.style.transform = `translate(${x}px, ${y}px) rotate(${rot}deg)`;

          if (t < 1){
            requestAnimationFrame(step);
          } else {
            // arrival
            ice.remove();
            catapult.classList.remove('arm-active');
            // splash at bear center and shake the bear
            spawnSplash(end.x, end.y);
            bear.classList.add('bear-shake');
            // Make bear lively
            bear.classList.remove('bear-dry');
            bear.classList.add('bear-happy');
            // revert after a few seconds
            setTimeout(() => {
              bear.classList.remove('bear-happy');
              bear.classList.remove('bear-shake');
              bear.classList.add('bear-dry');
            }, 6000);
          }
        }

        requestAnimationFrame(step);
      }

      // Click or keyboard to launch
      catapult.addEventListener('click', launchIce);
      catapult.addEventListener('keydown', (e) => {
        if (e.key === 'Enter' || e.key === ' ') {
          e.preventDefault();
          launchIce();
        }
      });
    })();
  </script>
</body>
</html>
